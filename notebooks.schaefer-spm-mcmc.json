{"version":2,"kind":"Notebook","sha256":"e04dcd40c6f6bc75da9f7b8bf51ade4467ba202c1d14a3be15289ad52a7ef630","slug":"notebooks.schaefer-spm-mcmc","location":"/notebooks/schaefer_spm_mcmc.ipynb","dependencies":[],"frontmatter":{"title":"A Bayesian implementation of a Schaefer Surplus Production population dynamics model","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Matheus de Barros","given":"Matheus","non_dropping_particle":"de","family":"Barros"},"name":"Matheus de Barros","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/matheusbarrosb/bayesian-mcmc-cookbook/blob/dev/myst.yml","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/matheusbarrosb/bayesian-mcmc-cookbook/blob/dev/myst.yml/blob/main/notebooks/schaefer_spm_mcmc.ipynb","exports":[{"format":"ipynb","filename":"schaefer_spm_mcmc.ipynb","url":"/bayesian-mcmc-cookbook/build/schaefer_spm_mcmc-cb56a262f5acfa0400ef9749bb190e99.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A Bayesian implementation of a Schaefer Surplus Production population dynamics model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fWfAcMILvP"}],"identifier":"a-bayesian-implementation-of-a-schaefer-surplus-production-population-dynamics-model","label":"A Bayesian implementation of a Schaefer Surplus Production population dynamics model","html_id":"a-bayesian-implementation-of-a-schaefer-surplus-production-population-dynamics-model","implicit":true,"key":"o3nw2cGc0K"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Background","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wGKdBcTUGp"}],"key":"vrP4zrHcyN"}],"identifier":"background","label":"Background","html_id":"background","implicit":true,"key":"tg6rmCzfzw"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"A Surplus Production Model (SPM) describes the population biomass dynamics as a single biomass entity, conditioned on relative abundance observations. SPMs are based on theta-logistic density-dependent population growth theory, where population growth rates are higher at low abundance, and lower when approaching the carrying capacity.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RkA8PwIF3N"}],"key":"HJJEkW0RBm"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"For a SPM in discrete time, the biomass (B) at a given point in time (usually years) can be described as a function of the biomass, surplus production (P), and catch (C) at the previous year.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xqsTxoQsnw"}],"key":"O6599xwPx6"},{"type":"math","value":"B_{t} = B_{t-1} + P_{t-1} - C_{t-1}","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub><mo>=</mo><msub><mi>B</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>P</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>C</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">B_{t} = B_{t-1} + P_{t-1} - C_{t-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"qSqbWr4gWK"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The surplus production ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fwdfHuWyXZ"},{"type":"inlineMath","value":"P","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"NF0pNachE0"},{"type":"text","value":" (i.e. the population growth in biomass at a given point in time) is a function of two parameters: the intrinsic rate of increase (","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jAMlXjtYq5"},{"type":"inlineMath","value":"r","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"dcuALDhzA0"},{"type":"text","value":"), and carrying capacity (K):","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VOEH1OBVhe"}],"key":"PZ27u0ElHu"},{"type":"math","value":"P_{t} = rB_{t}\\left(1 - \\frac{B_{t}}{K}\\right) - F_{t}B_{t}","position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub><mo>=</mo><mi>r</mi><msub><mi>B</mi><mi>t</mi></msub><mrow><mo fence=\"true\">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>B</mi><mi>t</mi></msub><mi>K</mi></mfrac><mo fence=\"true\">)</mo></mrow><mo>−</mo><msub><mi>F</mi><mi>t</mi></msub><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">P_{t} = rB_{t}\\left(1 - \\frac{B_{t}}{K}\\right) - F_{t}B_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"2","key":"AVj0s8XZwI"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Observations are indices of relative abundance (","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"aAO5RA2k3H"},{"type":"inlineMath","value":"I","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span>","key":"olQ9VCP6sr"},{"type":"text","value":") scaled to biomass through (estimated) cachability coefficients ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"EprzUDshyx"},{"type":"inlineMath","value":"q","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"IDmK2rGjhh"},{"type":"text","value":":","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"cDh9Xk2WSE"}],"key":"aIZ6dRagJT"},{"type":"math","value":"\\hat{I} = qB_{t}","position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>I</mi><mo>^</mo></mover><mo>=</mo><mi>q</mi><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{I} = qB_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9468em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9468em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1389em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"T04vTdK8eq"},{"type":"heading","depth":2,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Model Setup","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"LvNDKvpoHz"}],"key":"VoNe9EEMda"}],"identifier":"model-setup","label":"Model Setup","html_id":"model-setup","implicit":true,"key":"xElm4mUWxE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Data:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"RKsb5AndZp"}],"key":"fMGvjUKHPi"},{"type":"text","value":" Observed catches ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"VKaQSViUmY"},{"type":"inlineCode","value":"C","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"dYpT3II2Nh"},{"type":"text","value":" and one or more survey indices (columns starting with “Survey” followed by a number) over multiple years.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"tUc7QY683r"}],"key":"fX0XGlt9Z0"}],"key":"KxwwCHvX3K"},{"type":"heading","depth":2,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Likelihood","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"FUQ09h8RV3"}],"key":"rbK2H6SHy5"}],"identifier":"likelihood","label":"Likelihood","html_id":"likelihood","implicit":true,"key":"PmcRBe63LR"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"For each survey index, the likelihood is based on the log-normal errors between observed survey values and predicted biomass. The model assumes:","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Bv5VUo8Gy7"}],"key":"FYzoQkFmXm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"The observed survey index at time ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"i9ULIPBMUg"},{"type":"inlineMath","value":"t","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"AutJnpHe5w"},{"type":"text","value":" is ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"M8fKF7qVZ2"},{"type":"inlineMath","value":"I_t","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">I_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KHRTqfSnkY"},{"type":"text","value":".","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"MtXXKaz8so"}],"key":"Nh6iaQInkS"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"The predicted biomass at time ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"V90nVUWQYp"},{"type":"inlineMath","value":"t","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"w18fD3bAxZ"},{"type":"text","value":" (from the Schaefer model) is ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"wGZq9c1ROG"},{"type":"inlineMath","value":"B_t","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">B_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sUtsNQVbJM"},{"type":"text","value":".","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"CrDI4Y4hGW"}],"key":"vE4KFtoVCm"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"The catchability coefficient ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"RD8qe5zbQ1"},{"type":"inlineMath","value":"Q","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"fx6lqazaPW"},{"type":"text","value":" scales the expected survey to the biomass:\n","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"hAySAg3nkb"},{"type":"math","value":"Q = \\exp\\left(\\frac{1}{n} \\sum_{t=1}^n \\log\\left(\\frac{I_t}{B_t}\\right)\\right)","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msub><mi>I</mi><mi>t</mi></msub><msub><mi>B</mi><mi>t</mi></msub></mfrac><mo fence=\"true\">)</mo></mrow><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">Q = \\exp\\left(\\frac{1}{n} \\sum_{t=1}^n \\log\\left(\\frac{I_t}{B_t}\\right)\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0171em;vertical-align:-1.2671em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span></span>","enumerator":"4","key":"Zoph7MCc5k"}],"key":"lvU0I8wYRQ"},{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"The scaled prediction for the survey is ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"zMB2vlccWa"},{"type":"inlineMath","value":"P_t = I_t / Q","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub><mo>=</mo><msub><mi>I</mi><mi>t</mi></msub><mi mathvariant=\"normal\">/</mi><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">P_t = I_t / Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"hYFJXIuGUf"},{"type":"text","value":".","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"vPGePAEBey"}],"key":"hRdtx6nUzC"}],"key":"EFSuBjoOPV"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"The residuals follow a log-normal distribution:","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"JHEJn5mndw"}],"key":"uGxRiBeo97"},{"type":"math","value":"\\log\\left(\\frac{B_t}{P_t}\\right) \\sim N(0, \\sigma^2)","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msub><mi>B</mi><mi>t</mi></msub><msub><mi>P</mi><mi>t</mi></msub></mfrac><mo fence=\"true\">)</mo></mrow><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\log\\left(\\frac{B_t}{P_t}\\right) \\sim N(0, \\sigma^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"5","key":"sIeJnAss9l"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"This means that for each year ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"bzfUOox2Fu"},{"type":"inlineMath","value":"t","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"ZjqPao0F5m"},{"type":"text","value":", the probability density of observing ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"loPjqaRf48"},{"type":"inlineMath","value":"I_t","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">I_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ufY9lTch3P"},{"type":"text","value":" given predicted ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"bGAg8feOQh"},{"type":"inlineMath","value":"B_t","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">B_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uqrLKaSYL9"},{"type":"text","value":" and ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"TLxh8pmlx0"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"qgPA00JDdB"},{"type":"text","value":" is:","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"m5UsNvQFrh"}],"key":"Nlf7IaFIhu"},{"type":"math","value":"p(I_t \\mid B_t, Q, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left( -\\frac{1}{2\\sigma^2} \\left[\\log\\left(\\frac{B_t}{I_t/Q}\\right)\\right]^2 \\right)","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi>I</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>B</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><mi>Q</mi><mo separator=\"true\">,</mo><mi>σ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><mtext> </mtext><mi>σ</mi></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><msup><mrow><mo fence=\"true\">[</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msub><mi>B</mi><mi>t</mi></msub><mrow><msub><mi>I</mi><mi>t</mi></msub><mi mathvariant=\"normal\">/</mi><mi>Q</mi></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mo fence=\"true\">]</mo></mrow><mn>2</mn></msup><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">p(I_t \\mid B_t, Q, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left( -\\frac{1}{2\\sigma^2} \\left[\\log\\left(\\frac{B_t}{I_t/Q}\\right)\\right]^2 \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.2028em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">Q</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.654em;\"><span style=\"top:-3.9029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span></span>","enumerator":"6","key":"xYlp5Jo4lj"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"For each residual:","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"QdP8RGCgyg"}],"key":"NhDlnfahaH"},{"type":"math","value":"\\text{residual}_t = \\log\\left(\\frac{B_t}{I_t/Q}\\right)","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mtext>residual</mtext><mi>t</mi></msub><mo>=</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msub><mi>B</mi><mi>t</mi></msub><mrow><msub><mi>I</mi><mi>t</mi></msub><mi mathvariant=\"normal\">/</mi><mi>Q</mi></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{residual}_t = \\log\\left(\\frac{B_t}{I_t/Q}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">residual</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">Q</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"7","key":"oaKsIkMygY"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"and","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"z1sK3Bqdbw"}],"key":"ecyfS02cRo"},{"type":"math","value":"p(\\text{residual}_t \\mid \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left( -\\frac{\\text{residual}_t^2}{2\\sigma^2} \\right)","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mtext>residual</mtext><mi>t</mi></msub><mo>∣</mo><mi>σ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><mtext> </mtext><mi>σ</mi></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><mfrac><msubsup><mtext>residual</mtext><mi>t</mi><mn>2</mn></msubsup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">p(\\text{residual}_t \\mid \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left( -\\frac{\\text{residual}_t^2}{2\\sigma^2} \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">residual</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.5255em;vertical-align:-0.95em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.2028em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5754em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">residual</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8984em;\"><span style=\"top:-2.453em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"8","key":"T73qo3o0QD"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"veS3EyknST"},{"type":"strong","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"total likelihood","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"vaSgKI9MPk"}],"key":"wwx3mCBHdJ"},{"type":"text","value":" across years is the product of these normal pdfs across observations.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"wz4mEBauJi"}],"key":"YCzcPbknkC"},{"type":"thematicBreak","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"gsMBTqnIoR"},{"type":"heading","depth":2,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"strong","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Prior","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"w4PXYwIG6S"}],"key":"BCHXLH2HLA"}],"identifier":"prior","label":"Prior","html_id":"prior","implicit":true,"key":"LRW3iH4iaJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":66,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":66,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"Priors are placed on the parameters:","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"kLH57r1Djd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":67,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"inlineMath","value":"r \\sim N(\\mu_r, \\sigma^2_r)","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>μ</mi><mi>r</mi></msub><mo separator=\"true\">,</mo><msubsup><mi>σ</mi><mi>r</mi><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r \\sim N(\\mu_r, \\sigma^2_r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"OFRN1ErMwm"}],"key":"yypnUkI404"},{"type":"listItem","spread":true,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"inlineMath","value":"k \\sim N(\\mu_k, \\sigma^2_k)","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>μ</mi><mi>k</mi></msub><mo separator=\"true\">,</mo><msubsup><mi>σ</mi><mi>k</mi><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">k \\sim N(\\mu_k, \\sigma^2_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0972em;vertical-align:-0.2831em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"GL4qhmyFF3"}],"key":"itLdyTHGkm"},{"type":"listItem","spread":true,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"inlineMath","value":"\\sigma \\sim N(\\mu_\\sigma, \\sigma^2_\\sigma)","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>μ</mi><mi>σ</mi></msub><mo separator=\"true\">,</mo><msubsup><mi>σ</mi><mi>σ</mi><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma \\sim N(\\mu_\\sigma, \\sigma^2_\\sigma)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"xuwDQbffvG"}],"key":"X2tNnCQrBS"}],"key":"MSA4Way2F4"}],"key":"UwdZ8Be9bT"},{"type":"listItem","spread":true,"position":{"start":{"line":70,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"These are combined into the total NLL for use in Metropolis-Hastings.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"kzOHQbMZXy"}],"key":"k2ACEhTm8o"}],"key":"sDHZx7cvaN"},{"type":"thematicBreak","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"yIglD5qjoR"},{"type":"heading","depth":2,"position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"strong","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Posterior","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"ottn9Ksxbw"}],"key":"rusn6NlyGo"}],"identifier":"posterior","label":"Posterior","html_id":"posterior","implicit":true,"key":"xoRKid0uRN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":76,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"The (unormalized) posterior combines the likelihood and priors:\n","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"DyhNjI0MTB"},{"type":"math","value":"p(r, k, \\sigma | \\text{data}) \\propto p(\\text{data} | r, k, \\sigma) \\cdot p(r) \\cdot p(k) \\cdot p(\\sigma)","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>σ</mi><mi mathvariant=\"normal\">∣</mi><mtext>data</mtext><mo stretchy=\"false\">)</mo><mo>∝</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>data</mtext><mi mathvariant=\"normal\">∣</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>σ</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>σ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(r, k, \\sigma | \\text{data}) \\propto p(\\text{data} | r, k, \\sigma) \\cdot p(r) \\cdot p(k) \\cdot p(\\sigma)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\">∣</span><span class=\"mord text\"><span class=\"mord\">data</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∝</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">data</span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"9","key":"XpssuDufyF"}],"key":"coYJpBZO0q"}],"key":"LmoYqDu9tS"},{"type":"thematicBreak","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"qhQQerTx5s"},{"type":"heading","depth":2,"position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"strong","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Metropolis-Hastings Algorithm Steps in the Code","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"DKqEwZUJ3p"}],"key":"EqxmEqZVl5"}],"identifier":"metropolis-hastings-algorithm-steps-in-the-code","label":"Metropolis-Hastings Algorithm Steps in the Code","html_id":"metropolis-hastings-algorithm-steps-in-the-code","implicit":true,"key":"biWNLrbnH7"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":85,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"strong","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Initialization:","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"Kz2aXRJkXd"}],"key":"CvJhsY3nEN"}],"key":"as6p8UAxP8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":86,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Chains are initialized at given starting values (","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"gTpdnpDoSs"},{"type":"inlineCode","value":"inits","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"npcmvnvGPZ"},{"type":"text","value":").","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"ZSr3ZCIn3P"}],"key":"PDPm7wl33T"}],"key":"Q7NQM5uOR4"}],"key":"vfQgrRbvRX"},{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"strong","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Proposal Step:","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"HvTFWLIUZb"}],"key":"CGb1ntrKLK"}],"key":"atgnUGBj1s"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":89,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"At each iteration, propose new values for ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"zpKQHBt3xh"},{"type":"inlineMath","value":"r","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"Ov7u9e0eh0"},{"type":"text","value":", ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"rzwV6kXPhk"},{"type":"inlineMath","value":"k","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"I9Z4ET9gzf"},{"type":"text","value":", and ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"VUqhG7rOuv"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"EnqDLF6rkr"},{"type":"text","value":" using normal random walks:\n","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"IcsX6WLIKK"},{"type":"math","value":"r^* \\sim N(r^{(t-1)}, \\delta_{1}), \\quad k^* \\sim N(k^{(t-1)}, \\delta_{2}), \\quad \\sigma^* \\sim |N(\\sigma^{(t-1)}, \\delta_{2})|","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>r</mi><mo>∗</mo></msup><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>r</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msub><mi>δ</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi>k</mi><mo>∗</mo></msup><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>k</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msub><mi>δ</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi>σ</mi><mo>∗</mo></msup><mo>∼</mo><mi mathvariant=\"normal\">∣</mi><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msub><mi>δ</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">r^* \\sim N(r^{(t-1)}, \\delta_{1}), \\quad k^* \\sim N(k^{(t-1)}, \\delta_{2}), \\quad \\sigma^* \\sim |N(\\sigma^{(t-1)}, \\delta_{2})|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7387em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span></span>","enumerator":"10","key":"rCXfqmFird"}],"key":"cmk5WbQcBI"},{"type":"listItem","spread":true,"position":{"start":{"line":93,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Hard rejection if the proposed ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"LjwC8UC6eU"},{"type":"inlineMath","value":"r^* \\leq 0","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>r</mi><mo>∗</mo></msup><mo>≤</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r^* \\leq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;vertical-align:-0.136em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"fmUH3xQH0M"},{"type":"text","value":".","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"vktEb5MlGi"}],"key":"NLpYTpI14m"}],"key":"BSRrvnB0j8"}],"key":"aevKSguvjX"},{"type":"listItem","spread":true,"position":{"start":{"line":95,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"strong","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"Acceptance Ratio:","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"XG9YvKBcSa"}],"key":"bK0rXsocMw"}],"key":"tzswNdM7aK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":96,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"Compute the difference in negative log-likelihoods (including priors) between proposal and current values.","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"VSl7GxnTSF"}],"key":"wVYPQKWHSM"},{"type":"listItem","spread":true,"position":{"start":{"line":97,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"Accept the proposal with probability ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"U2OoosoiwG"},{"type":"inlineMath","value":"\\min(1, \\exp(\\text{logR}))","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mtext>logR</mtext><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\min(1, \\exp(\\text{logR}))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">min</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">logR</span></span><span class=\"mclose\">))</span></span></span></span>","key":"U2MzMhk3og"},{"type":"text","value":".","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"iu0EWCUdHV"}],"key":"gstKVNAXJo"}],"key":"uVxPW2K5TK"}],"key":"UG4lKODFGn"},{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"strong","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Update Step:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"G1Yz6V57Rt"}],"key":"WlJfwASHJC"}],"key":"wh4O9WAKea"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":100,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"If accepted, set ","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"qxpxUfi9Yd"},{"type":"inlineMath","value":"(r, k, \\sigma)^{(t)} = (r^*, k^*, \\sigma^*)","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>σ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>r</mi><mo>∗</mo></msup><mo separator=\"true\">,</mo><msup><mi>k</mi><mo>∗</mo></msup><mo separator=\"true\">,</mo><msup><mi>σ</mi><mo>∗</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r, k, \\sigma)^{(t)} = (r^*, k^*, \\sigma^*)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"w1fDqpAZtD"},{"type":"text","value":"; otherwise, retain previous values.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"GMtcbqZhQB"}],"key":"GDgAVZE85v"},{"type":"listItem","spread":true,"position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Repeat for ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"IuPDDRm9K7"},{"type":"inlineCode","value":"nIter","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"PldN0d0rQh"},{"type":"text","value":" iterations, discarding ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"BPB8X971fR"},{"type":"inlineCode","value":"nBurnIn","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"mw0pA48ZsD"},{"type":"text","value":" as burn-in.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"lLOeGichZZ"}],"key":"DuuGTAKPPB"}],"key":"LDveEc4Ymt"}],"key":"TH53uBax6C"}],"key":"B0U54Oe83z"}],"key":"abTvlUK1s1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom scipy.stats import gaussian_kde","key":"cwlccIjdVO"},{"type":"output","id":"euZWhbLNNZQlEt5gA2bpz","data":[],"key":"yvMEoRZ6zg"}],"key":"zJsaqCmpS6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def detect_survey_cols(data):\n    # Find all columns that start with 'Survey'\n    return [col for col in data.columns if col.lower().startswith(\"survey\")]\n\ndef NLL(par, data, survey_cols, priorMean, priorVar, printStep=False):\n    r, k, sigma = float(par[0]), float(par[1]), float(par[2])\n    nYears = len(data)\n    B = np.zeros(nYears)\n    B[0] = k\n\n    for t in range(1, nYears):\n        B[t] = max(1, B[t-1] + r * B[t-1] * (1 - B[t-1] / k) - data['C'].iloc[t-1])\n\n    # Likelihood components for each survey\n    NLLs = []\n    for survey_col in survey_cols:\n        survey_vals = data[survey_col]\n        Q   = np.exp(np.nanmean(np.log(survey_vals / B)))\n        PB  = survey_vals / Q\n        SSQ = np.log(B / PB) ** 2\n        idx = ~np.isnan(SSQ)\n        L = 1 / np.sqrt(2 * np.pi * sigma ** 2) * np.exp(-SSQ[idx] / (2 * sigma ** 2))\n        NLLs.append(-np.log(L))\n\n    # Priors\n    rPriorL     = -((r - priorMean[0]) ** 2 / (2 * priorVar[0]))\n    kPriorL     = -((k - priorMean[1]) ** 2 / (2 * priorVar[1]))\n    sigmaPriorL = -((sigma - priorMean[2]) ** 2 / (2 * priorVar[2]))\n    priorL = rPriorL + kPriorL + sigmaPriorL\n\n    # Total negative log-likelihood (minus sum for M-H log acceptance ratio)\n    totalNLL = sum(-np.sum(nll) for nll in NLLs) + priorL\n\n    if printStep:\n        print(f\"r: {r:.4f} k: {k:.2f} sigma: {sigma:.4f} nll: {totalNLL:.2f}\")\n\n    return totalNLL\n\ndef schaeferMCMC(data, inits, nIter, nBurnIn, delta, priors, nChains=2):\n    \"\"\"\n    Metropolis-Hastings sampler for the Schaefer biomass model.\n    Now uses a vector of proposal standard deviations (delta) for each parameter:\n        delta[0] = for r\n        delta[1] = for k\n        delta[2] = for sigma\n    \"\"\"\n    survey_cols = detect_survey_cols(data)\n    priorMean = priors[:3]\n    priorVar  = priors[3:]\n\n    if not (isinstance(delta, (list, tuple, np.ndarray)) and len(delta) == 3):\n        raise ValueError(\"delta must be a list/tuple/array of length 3: [delta_r, delta_k, delta_sigma]\")\n\n    chains = []\n    for chain_idx in range(nChains):\n        r     = np.zeros(nIter)\n        k     = np.zeros(nIter)\n        sigma = np.zeros(nIter)\n\n        if isinstance(inits[0], (list, np.ndarray)):\n            r[0], k[0], sigma[0] = inits[chain_idx]\n        else:\n            r[0], k[0], sigma[0] = inits\n\n        for i in range(1, nIter):\n            rHat     = np.random.normal(r[i-1], delta[0])\n            kHat     = np.random.normal(k[i-1], delta[1])\n            sigmaHat = abs(np.random.normal(sigma[i-1], delta[2]))\n\n            if rHat <= 0:\n                r[i], k[i], sigma[i] = r[i-1], k[i-1], sigma[i-1]\n                continue\n\n            logR = NLL([rHat, kHat, sigmaHat], data, survey_cols, priorMean, priorVar) - \\\n                   NLL([r[i-1], k[i-1], sigma[i-1]], data, survey_cols, priorMean, priorVar)\n\n            accept_prob = min(1, np.exp(logR))\n            if np.random.uniform() <= accept_prob:\n                r[i], k[i], sigma[i] = rHat, kHat, sigmaHat\n            else:\n                r[i], k[i], sigma[i] = r[i-1], k[i-1], sigma[i-1]\n\n        # Burn-in removal\n        rSamples     = r[nBurnIn:]\n        kSamples     = k[nBurnIn:]\n        sigmaSamples = sigma[nBurnIn:]\n\n        chains.append(pd.DataFrame({\n            'r': rSamples,\n            'k': kSamples,\n            'sigma': sigmaSamples\n        }))\n\n    # Plotting\n    fig, axs = plt.subplots(2, 3, figsize=(15, 8))\n    colors = ['black', '#FF000088', 'blue', 'green', 'orange', 'purple']\n    # Traceplots\n    for j, param in enumerate(['r', 'k', 'sigma']):\n        for cidx, chain in enumerate(chains):\n            axs[0, j].plot(chain[param], color=colors[cidx % len(colors)], alpha=0.7, label=f'Chain {cidx+1}' if j==0 else None)\n        axs[0, j].set_title(f'Trace: {param}')\n        if j == 0:\n            axs[0, j].legend()\n    # Density plots\n    for j, param in enumerate(['r', 'k', 'sigma']):\n        for cidx, chain in enumerate(chains):\n            kde = gaussian_kde(chain[param])\n            x_vals = np.linspace(chain[param].min(), chain[param].max(), 200)\n            axs[1, j].plot(x_vals, kde(x_vals), color=colors[cidx % len(colors)], label=f'Chain {cidx+1}')\n        axs[1, j].set_title(f'Density: {param}')\n        axs[1, j].legend()\n    plt.tight_layout()\n    plt.show()\n\n    # Posterior summaries (mean and sd per chain)\n    summaries = []\n    for chain in chains:\n        summaries.append(pd.DataFrame({\n            'Mean': [chain['r'].mean(), chain['k'].mean(), chain['sigma'].mean()],\n            'SD':   [chain['r'].std(),  chain['k'].std(),  chain['sigma'].std()]\n        }, index=['r', 'k', 'sigma']))\n\n    output = {\n        'chains': chains,\n        'summaries': summaries,\n        'survey_cols': survey_cols\n    }\n    return output\n\ndef schaefer_post_plots(data, mcmc_samples, survey_cols):\n    nYears = len(data)\n    nSamples = len(mcmc_samples)\n    biomass_matrix = np.zeros((nSamples, nYears))\n\n    # Calculate biomass time series for each posterior sample\n    for s in range(nSamples):\n        r = mcmc_samples.iloc[s]['r']\n        k = mcmc_samples.iloc[s]['k']\n        B = np.zeros(nYears)\n        B[0] = k\n        for t in range(1, nYears):\n            B[t] = max(1, B[t-1] + r * B[t-1] * (1 - B[t-1] / k) - data['C'].iloc[t-1])\n        biomass_matrix[s, :] = B\n\n    biomass_mean = biomass_matrix.mean(axis=0)\n    biomass_lower = np.percentile(biomass_matrix, 2.5, axis=0)\n    biomass_upper = np.percentile(biomass_matrix, 97.5, axis=0)\n\n    # ----- SCALE THE SURVEYS -----\n    scaled_surveys = {}\n    for survey_col in survey_cols:\n        survey_vals = data[survey_col].values\n        mask = survey_vals > 0\n        # Avoid division by zero or log of zero with masking\n        q = np.exp(np.nanmean(np.log(survey_vals[mask] / biomass_mean[mask])))\n        scaled_surveys[survey_col] = survey_vals / q\n\n    # ----- Plotting -----\n    fig, axs = plt.subplots(1, 3, figsize=(15, 5))\n\n    # 1. Biomass time series with CI and scaled surveys\n    axs[0].plot(biomass_mean, color='black', label='Mean')\n    axs[0].plot(biomass_lower, color='black', linestyle='--', label='Lower CI')\n    axs[0].plot(biomass_upper, color='black', linestyle='--', label='Upper CI')\n    colors = ['red', 'blue', 'green', 'orange', 'purple']\n    for idx, (survey_col, scaled) in enumerate(scaled_surveys.items()):\n        axs[0].plot(np.arange(nYears), scaled, 'o', label=survey_col, color=colors[idx % len(colors)])\n    axs[0].set_ylabel(\"biomass\")\n    axs[0].set_xlabel(\"Index\")\n    axs[0].legend()\n\n    # 2. B/Bmsy\n    k_samples = mcmc_samples['k'].values\n    bbmsy_matrix = biomass_matrix / (k_samples[:, None] / 2)\n    bbmsy_mean = bbmsy_matrix.mean(axis=0)\n    axs[1].plot(bbmsy_mean, color='black')\n    axs[1].set_ylabel(\"biomassSB/(k/2)\")\n    axs[1].set_xlabel(\"Index\")\n    axs[1].set_title(\"B/Bmsy\")\n\n    # 3. F/Fmsy\n    catch = data['C'].values\n    r_samples = mcmc_samples['r'].values\n    f_matrix = catch / biomass_matrix\n    fmsy_matrix = r_samples[:, None] / 2\n    ffmsy_matrix = f_matrix / fmsy_matrix\n    ffmsy_mean = ffmsy_matrix.mean(axis=0)\n    axs[2].plot(ffmsy_mean, color='black')\n    axs[2].set_ylabel(\"FM/Fmsy\")\n    axs[2].set_xlabel(\"Index\")\n    axs[2].set_title(\"F/Fmsy\")\n\n    plt.tight_layout()\n    plt.show()\n\n    return {\n        \"biomass_mean\": biomass_mean,\n        \"biomass_lower\": biomass_lower,\n        \"biomass_upper\": biomass_upper,\n        \"scaled_surveys\": scaled_surveys\n    }","key":"Q7e29mDhZm"},{"type":"output","id":"RAqiiDgWKTW8O7-W99JT-","data":[],"key":"XU90xM1cVz"}],"key":"OvZLUzTqsn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can find some example usage below. Be warned that way more iterations (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ncyllMsRrh"},{"type":"inlineCode","value":"nIter","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WfOQvS5HZC"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"krtL6uHPXt"},{"type":"inlineCode","value":"nBurnIn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YUgO2ZJCXi"},{"type":"text","value":") are needed to achieve appropriate chain mixing and accurate parameter estimation. The example in this cookbook runs with fewer iterations due to computational limitations involved in deploying the cookbook.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DOU5Xjh2AC"}],"key":"YtoWECwhYs"}],"key":"i2AsRBpbhz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Example usage ---\ndata = pd.read_csv('../data/data.csv')\nprint(\"Data loaded:\", data.shape) # rows, cols\n\n# Initial parameters, number of iterations, burn-in, delta, priors\ninits = [0.19, 144000, 0.9] # r, k, sigma\nnIter = 10000 # reduce for testing\nnBurnIn = 1000\ndelta = [0.0075, 20000, 0.05] # proposal distribution variances\npriors = [0.23, 144000, 0.9, 0.005, 50000, 0.01]  # priors: means (1:3) and variances (4:6)\n\nresult = schaeferMCMC(data, inits, nIter, nBurnIn, delta, priors)\n\n# Print means and SDs for each chain\nfor i, summary in enumerate(result['summaries']):\n    print(f\"Chain {i+1} parameter means and SDs:\\n{summary}\\n\")\n\nschaefer_post_plots(data, result['chains'][1], result['survey_cols'])","key":"M0y29lajpo"},{"type":"output","id":"nunE_rqlrNI9mtsVc-4-W","data":[{"output_type":"stream","name":"stdout","text":"Data loaded: (106, 4)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x800 with 6 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f255175ef70f058f09ef5bdd62285b59","path":"/bayesian-mcmc-cookbook/build/f255175ef70f058f09ef5bdd62285b59.png"}}},{"output_type":"stream","name":"stdout","text":"Chain 1 parameter means and SDs:\n                Mean          SD\nr           0.196903    0.001700\nk      143911.835894  201.857793\nsigma       0.808573    0.044545\n\nChain 2 parameter means and SDs:\n                Mean          SD\nr           0.198135    0.003071\nk      144027.386845  240.916180\nsigma       0.852334    0.087908\n\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x500 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"29903c718af174121777a0d55c0f8ea2","path":"/bayesian-mcmc-cookbook/build/29903c718af174121777a0d55c0f8ea2.png"}}},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"{'biomass_mean': array([144027.38684546, 143949.38684546, 143842.83300467, 143739.35198819,\n        143699.30532262, 143665.15712786, 143654.74030034, 143657.37483679,\n        143652.48833982, 143676.56366412, 143683.89172515, 143656.77416191,\n        143651.00243029, 143636.36771855, 143626.61664926, 143593.78640441,\n        143579.42274523, 143567.88685843, 143572.62149794, 143571.42329522,\n        143563.46048419, 143544.06488867, 143536.48655832, 143549.39909446,\n        143566.76993259, 143536.72116244, 143503.58674461, 143459.97086282,\n        143080.93078482, 142306.20167511, 141022.1264559 , 140445.11250326,\n        140494.17675936, 140698.97882009, 140969.11867513, 141138.095718  ,\n        141144.96777432, 141162.52868977, 141249.74574501, 141341.35644971,\n        141398.50311926, 141308.74469764, 141076.11089363, 140946.75539432,\n        140871.95403636, 140672.32860842, 140644.4650919 , 140540.85954648,\n        140780.79907289, 140808.41601641, 141171.8055609 , 137439.23025099,\n        133863.72731707, 133347.23686617, 134459.21970945, 135376.8013459 ,\n        135895.53948254, 136496.45261019, 136754.23803994, 137219.19264007,\n        137632.02780129, 137522.56684008, 137667.85942369, 137302.94010673,\n        129185.76297592, 109982.10063004,  87273.89939137,  68056.5579957 ,\n         64727.13127417,  61444.16452378,  59093.50223546,  56223.78836819,\n         49920.62809795,  45737.97169226,  39212.88415274,  34404.44752612,\n         32795.04084908,  31399.96833624,  27915.87015574,  25654.81797364,\n         22915.93205003,  20407.38058334,  17215.4411044 ,  16056.34485709,\n         14760.64074011,  13325.84752132,  13720.74715841,  15695.7628088 ,\n         18346.56518186,  21323.91222138,  24583.44821026,  28219.29956989,\n         32229.95686826,  36615.78025318,  41470.87981533,  46701.6536641 ,\n         52222.41910862,  57939.51194798,  63653.61366177,  69230.64235371,\n         75047.48014626,  80740.41277031,  82037.69845005,  78788.84676598,\n         75723.73999464,  73823.69292587]),\n 'biomass_lower': array([1.43594872e+05, 1.43516872e+05, 1.43410141e+05, 1.43306275e+05,\n        1.43265686e+05, 1.43231012e+05, 1.43220097e+05, 1.43222308e+05,\n        1.43217089e+05, 1.43240886e+05, 1.43248047e+05, 1.43220811e+05,\n        1.43214884e+05, 1.43200111e+05, 1.43190216e+05, 1.43157248e+05,\n        1.43142699e+05, 1.43130982e+05, 1.43135546e+05, 1.43134221e+05,\n        1.43126154e+05, 1.43106657e+05, 1.43098953e+05, 1.43111748e+05,\n        1.43129053e+05, 1.43098992e+05, 1.43065779e+05, 1.43022025e+05,\n        1.42642774e+05, 1.41867015e+05, 1.40580358e+05, 1.39998382e+05,\n        1.40042144e+05, 1.40242761e+05, 1.40509975e+05, 1.40677198e+05,\n        1.40683039e+05, 1.40699782e+05, 1.40786379e+05, 1.40877688e+05,\n        1.40934802e+05, 1.40845148e+05, 1.40612393e+05, 1.40482405e+05,\n        1.40406795e+05, 1.40206345e+05, 1.40177356e+05, 1.40072776e+05,\n        1.40311689e+05, 1.40339026e+05, 1.40702253e+05, 1.36970385e+05,\n        1.33386993e+05, 1.32856168e+05, 1.33955145e+05, 1.34864424e+05,\n        1.35378395e+05, 1.35976582e+05, 1.36233528e+05, 1.36698399e+05,\n        1.37112261e+05, 1.37004617e+05, 1.37151137e+05, 1.36787565e+05,\n        1.28670630e+05, 1.09448872e+05, 8.66873470e+04, 6.73850194e+04,\n        6.39475405e+04, 6.05132136e+04, 5.79963170e+04, 5.49504229e+04,\n        4.84575411e+04, 4.40591989e+04, 3.72919547e+04, 3.22004000e+04,\n        3.02623408e+04, 2.84961559e+04, 2.45918980e+04, 2.18387931e+04,\n        1.85282387e+04, 1.53466970e+04, 1.13592758e+04, 9.24453469e+03,\n        6.82351852e+03, 4.05535626e+03, 2.85966327e+03, 2.97565451e+03,\n        3.50028443e+03, 4.07733181e+03, 4.65267018e+03, 5.31508804e+03,\n        6.07038066e+03, 6.93790698e+03, 8.04485818e+03, 9.35562137e+03,\n        1.08564111e+04, 1.25379987e+04, 1.42943599e+04, 1.60755017e+04,\n        1.83318219e+04, 2.08338792e+04, 1.94039194e+04, 1.32587269e+04,\n        6.29708568e+03, 1.00000000e+00]),\n 'biomass_upper': array([144439.2662041 , 144361.2662041 , 144254.94035998, 144151.95348918,\n        144112.60547276, 144079.13511188, 144069.36227996, 144072.54443548,\n        144068.09005199, 144092.52668836, 144100.07453237, 144073.112019  ,\n        144067.54409659, 144053.08993779, 144043.52667287, 144010.87578233,\n        143996.75220003, 143985.4511732 , 143990.40822265, 143989.37483989,\n        143981.54793551, 143962.28481454, 143954.86965978, 143967.93546755,\n        143985.39165563, 143955.36059645, 143922.32835856, 143878.89153943,\n        143500.12295778, 142726.71870515, 141445.95981274, 140875.31973041,\n        140931.20351431, 141141.40147691, 141415.32856843, 141586.5906152 ,\n        141594.81980049, 141613.45969224, 141701.49898494, 141793.51897902,\n        141850.72708187, 141760.84978918, 141528.38421735, 141399.8493577 ,\n        141326.09299626, 141127.5343578 , 141101.12197734, 140998.77556204,\n        141240.04111895, 141268.02788501, 141631.63582931, 137898.16317325,\n        134332.75461661, 133801.40554089, 134899.90241788, 135851.4895928 ,\n        136392.52185167, 137005.6949993 , 137266.53085878, 137730.97205743,\n        138137.97162785, 138018.95191721, 138157.79741118, 137785.96490968,\n        129667.45085723, 110523.77853506,  87901.31083495,  68983.88355294,\n         65913.52865527,  62900.17275273,  60833.57022397,  58263.64172819,\n         52281.79103372,  48462.40877394,  42342.97178975,  38006.04579506,\n         36940.59782457,  36155.30820033,  33355.68313775,  31888.98250327,\n         30062.76947583,  28615.18838075,  26658.75421193,  26959.20351342,\n         27344.30828511,  27849.58567353,  30488.74185459,  34982.77597655,\n         40366.43691762,  46231.78346543,  52469.33920004,  59092.48216104,\n         65996.32494742,  73065.42560197,  80273.16418673,  87399.59125567,\n         94255.83370301, 100678.84447956, 106441.5769792 , 111437.82974973,\n        116114.64120984, 120151.1730206 , 119375.13969286, 114188.92931193,\n        109766.38200126, 106869.52021311]),\n 'scaled_surveys': {'Survey 1': array([           nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n         52272.96423775,            nan,            nan, 78085.26176584,\n                    nan,            nan, 42122.38449533,            nan,\n                    nan, 27987.93633733,            nan,            nan,\n         53605.72311095,            nan,            nan, 42396.14037199,\n                    nan,            nan, 70009.46340441,            nan,\n                    nan, 14271.32609633,            nan,            nan,\n          7701.18505653,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan]),\n  'Survey 2': array([            nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,  10791.9885058 ,\n          15557.66310168,   5091.03052598,   4976.44974505,  15605.17526358,\n           9105.57837598,  46287.20893687,  74074.09299486,  74573.24231222,\n          92841.85660384,  91434.25135015, 139614.38326125, 114654.24300587,\n         171707.57410886, 150883.29023997, 118612.12727493,             nan,\n                     nan,             nan])}}","content_type":"text/plain"}}}],"key":"Hbqr5tx6HE"}],"key":"eOr92on6Wv"}],"key":"ZWuu7Xi6SW"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"A MCMC implementation for a Bayesian Poisson Regression","url":"/notebooks/poisson-mcmc","group":"Applying MCMC algorithms to a variety of Bayesian models"}}},"domain":"http://localhost:3000"}