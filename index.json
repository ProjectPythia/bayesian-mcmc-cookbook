{"version":2,"kind":"Article","sha256":"9d620070fd4aa83c960f81e9ea15206527e3e9e18a243a6fb94e73f8cd2082ad","slug":"index","location":"/README.md","dependencies":[],"frontmatter":{"title":"Bayesian Monte Carlo Markov Chain modelling Cookbook","content_includes_title":false,"authors":[{"nameParsed":{"literal":"Matheus de Barros","given":"Matheus","non_dropping_particle":"de","family":"Barros"},"name":"Matheus de Barros","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/matheusbarrosb/bayesian-mcmc-cookbook/blob/dev/myst.yml","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"edit_url":"https://github.com/matheusbarrosb/bayesian-mcmc-cookbook/blob/dev/myst.yml/blob/main/README.md","thumbnail":"/bayesian-mcmc-cookbook/build/thumbnail-4fa2f7ede296f22ac39f73c213fe32d7.png","exports":[{"format":"md","filename":"README.md","url":"/bayesian-mcmc-cookbook/build/README-82a18e5187f120ea5bdd20a812d5cf47.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"image","url":"/bayesian-mcmc-cookbook/build/thumbnail-4fa2f7ede296f22ac39f73c213fe32d7.png","width":300,"key":"zPveCFJILk","urlSource":"thumbnail.png"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Motivation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gPSBoNLGGc"}],"identifier":"motivation","label":"Motivation","html_id":"motivation","implicit":true,"key":"ANi4jN7DzI"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"While there are many dedicated packages to perform Bayesian estimation, it might be very useful to understand what’s under the hood, so scientists and students are increasingly knowledgeable and empowered to make the best modelling decisions. This cookbook is an effort to demonstrate how Monte Carlo Markov Chain (MCMC) algorithms play a role in Bayesian estimation. I have included several applications of this algorithm to different models - starting from estimating basic normal distribution parameters and regressions, all the way to more complex population dynamics models.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SRty4x3Yg9"}],"key":"hy7Bf3t2IK"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Authors","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"S2WA8ru9Yi"}],"identifier":"authors","label":"Authors","html_id":"authors","implicit":true,"key":"liTr8O0Mor"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"https://github.com/matheusbarrosb","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Matheus de Barros","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QQsiqNg2vy"}],"urlSource":"https://github.com/matheusbarrosb","error":true,"key":"wHNiyfyY5L"}],"key":"hQ48HrihDE"},{"type":"heading","depth":3,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Background","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wMUgmiNNXm"}],"identifier":"background","label":"Background","html_id":"background","implicit":true,"key":"YTQTPyJfja"},{"type":"heading","depth":4,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Bayes’ rule and probability statements","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mmrZYSSdqm"}],"identifier":"bayes-rule-and-probability-statements","label":"Bayes’ rule and probability statements","html_id":"bayes-rule-and-probability-statements","implicit":true,"key":"ZeuDppQNKk"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Bayes’ Rule and Probability Statements","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yjOTMl6NRD"}],"identifier":"bayes-rule-and-probability-statements","label":"Bayes’ Rule and Probability Statements","html_id":"bayes-rule-and-probability-statements-1","implicit":true,"key":"lbMGIXUUVX"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"In Bayesian models, the goal is to estimate the posterior distribution given a prior distribution p(θ) (what we already know about the parameters), and the likelihood p(y|θ) (the probability of observing the data y given parameter values θ).","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"DHXmhGTqd4"}],"key":"A7fC28kqQ5"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"To estimate model parameters θ given data y, we specify the joint probability distribution:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Ps7WjVPq7T"}],"key":"BeoEhkVer9"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"p(y, θ) = p(y|θ) p(θ)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"HHnOI1XdQy"}],"key":"wRm4z8fD3t"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Applying Bayes’ rule:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"CAVh4DDmO1"}],"key":"b2iCP3DkNy"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"p(θ|y) = [p(y|θ) p(θ)] / p(y)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"a1V0gJL9Q7"}],"key":"wYxxnBwEVb"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"where p(y) = ∫ p(y|θ) p(θ) dθ is the marginal likelihood (normalizing constant).","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"bXQRAzmOQW"}],"key":"nOJ56ulpLV"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"The unnormalized posterior can be written as:","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"QfDXfMoNnP"}],"key":"W9KBz4JiZ6"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"p(θ|y) ∝ p(θ) p(y|θ)","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"bWylnyu7Dy"}],"key":"AuLUwQBopb"},{"type":"thematicBreak","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"zF7HVVZt29"},{"type":"heading","depth":4,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"The Metropolis-Hastings Algorithm","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"C78van4QHG"}],"identifier":"the-metropolis-hastings-algorithm","label":"The Metropolis-Hastings Algorithm","html_id":"the-metropolis-hastings-algorithm","implicit":true,"key":"ev1W4caslI"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"strong","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Steps:","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"Po8CenTk4g"}],"key":"eELuhO85vy"}],"key":"U6mRyi4SKN"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":41,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"strong","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Initialization:","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"mSjxMAVWAY"}],"key":"hsPi3LKXTf"},{"type":"text","value":" Start with an initial value θ(0).","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"ByOJvgJu8j"}],"key":"I8ASZl2r4Q"}],"key":"gItUJ1yDVp"},{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Proposal:","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"snrgRwSWoD"}],"key":"rRMQOQ0aOv"},{"type":"text","value":" At iteration t, propose θ* from q(θ* | θ(t-1)).","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"zzSwKY5sZR"}],"key":"EKypEJEH4j"}],"key":"i6ZEajMdTR"},{"type":"listItem","spread":true,"position":{"start":{"line":43,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Acceptance Ratio:","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"f7wZmravkC"}],"key":"GgDEwXyrsQ"},{"type":"text","value":" Compute","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"SQMzXDXji4"}],"key":"LRPkdPnOUo"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"α = min(1, [p(θ*) q(θ(t-1)|θ*)] / [p(θ(t-1)) q(θ*|θ(t-1))])","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"yYRLEU54q5"}],"key":"BATxVR3Wmx"}],"key":"jD2PhwRySV"},{"type":"listItem","spread":true,"position":{"start":{"line":47,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Accept or Reject:","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"SdEgJzgUl1"}],"key":"D2O3OeGKs4"},{"type":"text","value":" Draw u ~ Uniform(0,1).","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"UOEm8FWp3I"}],"key":"fNWfnoCyCU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":48,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"If u < α, set θ(t) = θ*.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"jxKKNjLcTa"}],"key":"HpWjbUnQmm"},{"type":"listItem","spread":true,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Else, θ(t) = θ(t-1).","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"l5khKOCYhY"}],"key":"OnxHMbbEO6"}],"key":"LkQnaMsVNI"}],"key":"qozzLPe6iz"},{"type":"listItem","spread":true,"position":{"start":{"line":50,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"strong","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Iterate:","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"UrVrysIhQZ"}],"key":"kcgHxWvpYS"},{"type":"text","value":" Repeat steps 2–4 as needed.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"gscBBvvtA5"}],"key":"ovLaLBQ1xK"}],"key":"KAYrIDLaF5"}],"key":"P5pHE7MP7g"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"strong","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Key Properties:","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"z7g6ZHrgQa"}],"key":"AgQWqtMjD9"}],"key":"Lbj7Tf7HGu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":53,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"The sequence {θ(t)} forms a Markov chain with stationary distribution p(θ).","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ZIuPecb2VH"}],"key":"R8eXn4RDKQ"},{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Only the unnormalized target distribution is needed.","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"UC6iNe0nxk"}],"key":"a9ICfDFQ6w"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"After burn-in, use remaining samples for posterior inference.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"rWIx7ZyduB"}],"key":"dpmUBE11Jj"}],"key":"eIihICd9Fp"}],"key":"r3E2svjLoN"}],"key":"dJAbV9eF6f"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"next":{"title":"How to Cite This Cookbook","url":"/notebooks/how-to-cite","group":"Preamble"}}},"domain":"http://localhost:3000"}