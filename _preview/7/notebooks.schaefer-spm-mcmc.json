{"version":2,"kind":"Notebook","sha256":"e04dcd40c6f6bc75da9f7b8bf51ade4467ba202c1d14a3be15289ad52a7ef630","slug":"notebooks.schaefer-spm-mcmc","location":"/notebooks/schaefer_spm_mcmc.ipynb","dependencies":[],"frontmatter":{"title":"A Bayesian implementation of a Schaefer Surplus Production population dynamics model","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Matheus de Barros","given":"Matheus","non_dropping_particle":"de","family":"Barros"},"name":"Matheus de Barros","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/matheusbarrosb/bayesian-mcmc-cookbook/blob/dev/myst.yml","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/matheusbarrosb/bayesian-mcmc-cookbook/blob/dev/myst.yml/blob/HEAD/notebooks/schaefer_spm_mcmc.ipynb","exports":[{"format":"ipynb","filename":"schaefer_spm_mcmc.ipynb","url":"/bayesian-mcmc-cookbook/_preview/7/build/schaefer_spm_mcmc-31cc300b5c40ddf552df5734f73241d3.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A Bayesian implementation of a Schaefer Surplus Production population dynamics model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vk5prJ4WEA"}],"identifier":"a-bayesian-implementation-of-a-schaefer-surplus-production-population-dynamics-model","label":"A Bayesian implementation of a Schaefer Surplus Production population dynamics model","html_id":"a-bayesian-implementation-of-a-schaefer-surplus-production-population-dynamics-model","implicit":true,"key":"mnXy3uJSvS"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Background","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aM1TemVAcv"}],"key":"iyRRUhnEIT"}],"identifier":"background","label":"Background","html_id":"background","implicit":true,"key":"WnDv9a1suN"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"A Surplus Production Model (SPM) describes the population biomass dynamics as a single biomass entity, conditioned on relative abundance observations. SPMs are based on theta-logistic density-dependent population growth theory, where population growth rates are higher at low abundance, and lower when approaching the carrying capacity.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aEknxCGlNi"}],"key":"dK05IP8Cki"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"For a SPM in discrete time, the biomass (B) at a given point in time (usually years) can be described as a function of the biomass, surplus production (P), and catch (C) at the previous year.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KffJFqZRQn"}],"key":"gcPEHmQZNc"},{"type":"math","value":"B_{t} = B_{t-1} + P_{t-1} - C_{t-1}","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub><mo>=</mo><msub><mi>B</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>P</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>C</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">B_{t} = B_{t-1} + P_{t-1} - C_{t-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"wbbUud5raz"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The surplus production ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fxcRBogVMK"},{"type":"inlineMath","value":"P","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"A0SVpbrX24"},{"type":"text","value":" (i.e. the population growth in biomass at a given point in time) is a function of two parameters: the intrinsic rate of increase (","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zzo4joCOvT"},{"type":"inlineMath","value":"r","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"hZeQLr5QdQ"},{"type":"text","value":"), and carrying capacity (K):","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"C04TYCawt6"}],"key":"iNhFJuznaD"},{"type":"math","value":"P_{t} = rB_{t}\\left(1 - \\frac{B_{t}}{K}\\right) - F_{t}B_{t}","position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub><mo>=</mo><mi>r</mi><msub><mi>B</mi><mi>t</mi></msub><mrow><mo fence=\"true\">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>B</mi><mi>t</mi></msub><mi>K</mi></mfrac><mo fence=\"true\">)</mo></mrow><mo>−</mo><msub><mi>F</mi><mi>t</mi></msub><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">P_{t} = rB_{t}\\left(1 - \\frac{B_{t}}{K}\\right) - F_{t}B_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"2","key":"LvuTzR9eo9"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Observations are indices of relative abundance (","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"uVU5yAZKpH"},{"type":"inlineMath","value":"I","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span>","key":"Y1tuoD3bci"},{"type":"text","value":") scaled to biomass through (estimated) cachability coefficients ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Vw5pjHe94l"},{"type":"inlineMath","value":"q","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"izNFxMEEo2"},{"type":"text","value":":","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"xieomnvVd2"}],"key":"AYfOeHjwNR"},{"type":"math","value":"\\hat{I} = qB_{t}","position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>I</mi><mo>^</mo></mover><mo>=</mo><mi>q</mi><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{I} = qB_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9468em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9468em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1389em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"E0k224Yy9S"},{"type":"heading","depth":2,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Model Setup","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"vwouB7fjBz"}],"key":"wXuAVsMbFi"}],"identifier":"model-setup","label":"Model Setup","html_id":"model-setup","implicit":true,"key":"WnX6BTFnxH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Data:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"iMlxB2rLH6"}],"key":"cXykT2SxBd"},{"type":"text","value":" Observed catches ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"aF7gg9tDOi"},{"type":"inlineCode","value":"C","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"fRmYZCuRKu"},{"type":"text","value":" and one or more survey indices (columns starting with “Survey” followed by a number) over multiple years.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"PH91McOGeu"}],"key":"SqOo5Z8x2u"}],"key":"BRaOymBVDa"},{"type":"heading","depth":2,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Likelihood","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"HoNT1QGmuP"}],"key":"gs9YkHylRW"}],"identifier":"likelihood","label":"Likelihood","html_id":"likelihood","implicit":true,"key":"TJJa8autF0"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"For each survey index, the likelihood is based on the log-normal errors between observed survey values and predicted biomass. The model assumes:","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"tVUHTRo49a"}],"key":"zvr9DBUq93"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"The observed survey index at time ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"IOjXR4J9xR"},{"type":"inlineMath","value":"t","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"k95zUwOSlW"},{"type":"text","value":" is ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"IOSAHWjZCB"},{"type":"inlineMath","value":"I_t","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">I_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"D4OhQ665KY"},{"type":"text","value":".","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"KVdowwdYkv"}],"key":"AtJMm2EDta"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"The predicted biomass at time ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"P9MNojdIJW"},{"type":"inlineMath","value":"t","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"IlN6FhQMFC"},{"type":"text","value":" (from the Schaefer model) is ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"PRE0olIote"},{"type":"inlineMath","value":"B_t","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">B_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qTiyO91TSJ"},{"type":"text","value":".","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"pqvdomTeUU"}],"key":"JvRndCsciX"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"The catchability coefficient ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"T4G4sZQK1V"},{"type":"inlineMath","value":"Q","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"LJHvslKb1U"},{"type":"text","value":" scales the expected survey to the biomass:\n","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"bewMQ22oK6"},{"type":"math","value":"Q = \\exp\\left(\\frac{1}{n} \\sum_{t=1}^n \\log\\left(\\frac{I_t}{B_t}\\right)\\right)","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msub><mi>I</mi><mi>t</mi></msub><msub><mi>B</mi><mi>t</mi></msub></mfrac><mo fence=\"true\">)</mo></mrow><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">Q = \\exp\\left(\\frac{1}{n} \\sum_{t=1}^n \\log\\left(\\frac{I_t}{B_t}\\right)\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0171em;vertical-align:-1.2671em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span></span>","enumerator":"4","key":"W0TLefOd11"}],"key":"ZiAqawxk5X"},{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"The scaled prediction for the survey is ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"CLpAOt4oti"},{"type":"inlineMath","value":"P_t = I_t / Q","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub><mo>=</mo><msub><mi>I</mi><mi>t</mi></msub><mi mathvariant=\"normal\">/</mi><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">P_t = I_t / Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"lboi2vVP83"},{"type":"text","value":".","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"eQm286FV1P"}],"key":"VcjAEMvxnm"}],"key":"wF3JcLb0WZ"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"The residuals follow a log-normal distribution:","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"Y10X05HnRv"}],"key":"C6vUMaXrmo"},{"type":"math","value":"\\log\\left(\\frac{B_t}{P_t}\\right) \\sim N(0, \\sigma^2)","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msub><mi>B</mi><mi>t</mi></msub><msub><mi>P</mi><mi>t</mi></msub></mfrac><mo fence=\"true\">)</mo></mrow><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\log\\left(\\frac{B_t}{P_t}\\right) \\sim N(0, \\sigma^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"5","key":"c21x6bnLxw"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"This means that for each year ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"mLI5xHDEfq"},{"type":"inlineMath","value":"t","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"GnDoAkMKQI"},{"type":"text","value":", the probability density of observing ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"VOvqNkxi6x"},{"type":"inlineMath","value":"I_t","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">I_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uM0yx6gBSq"},{"type":"text","value":" given predicted ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"NQXZXKlVlV"},{"type":"inlineMath","value":"B_t","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">B_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uD6N5SiP9T"},{"type":"text","value":" and ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"RVzMz4OnXV"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"Jskdvk9GLy"},{"type":"text","value":" is:","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"nwPml7iFov"}],"key":"ZxsEHqg8hX"},{"type":"math","value":"p(I_t \\mid B_t, Q, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left( -\\frac{1}{2\\sigma^2} \\left[\\log\\left(\\frac{B_t}{I_t/Q}\\right)\\right]^2 \\right)","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi>I</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>B</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><mi>Q</mi><mo separator=\"true\">,</mo><mi>σ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><mtext> </mtext><mi>σ</mi></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><msup><mrow><mo fence=\"true\">[</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msub><mi>B</mi><mi>t</mi></msub><mrow><msub><mi>I</mi><mi>t</mi></msub><mi mathvariant=\"normal\">/</mi><mi>Q</mi></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mo fence=\"true\">]</mo></mrow><mn>2</mn></msup><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">p(I_t \\mid B_t, Q, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left( -\\frac{1}{2\\sigma^2} \\left[\\log\\left(\\frac{B_t}{I_t/Q}\\right)\\right]^2 \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.2028em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">Q</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.654em;\"><span style=\"top:-3.9029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span></span>","enumerator":"6","key":"lmC2TBrPLX"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"For each residual:","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"ZyIXsZ3OxZ"}],"key":"IvLgXzYC2b"},{"type":"math","value":"\\text{residual}_t = \\log\\left(\\frac{B_t}{I_t/Q}\\right)","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mtext>residual</mtext><mi>t</mi></msub><mo>=</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msub><mi>B</mi><mi>t</mi></msub><mrow><msub><mi>I</mi><mi>t</mi></msub><mi mathvariant=\"normal\">/</mi><mi>Q</mi></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{residual}_t = \\log\\left(\\frac{B_t}{I_t/Q}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">residual</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">Q</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"7","key":"cQbl7b8jpA"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"and","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"kNBcviX6mx"}],"key":"aNUOsBr3ey"},{"type":"math","value":"p(\\text{residual}_t \\mid \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left( -\\frac{\\text{residual}_t^2}{2\\sigma^2} \\right)","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mtext>residual</mtext><mi>t</mi></msub><mo>∣</mo><mi>σ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><mtext> </mtext><mi>σ</mi></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><mfrac><msubsup><mtext>residual</mtext><mi>t</mi><mn>2</mn></msubsup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">p(\\text{residual}_t \\mid \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left( -\\frac{\\text{residual}_t^2}{2\\sigma^2} \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">residual</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.5255em;vertical-align:-0.95em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.2028em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5754em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">residual</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8984em;\"><span style=\"top:-2.453em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"8","key":"aFu3qBNKXm"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"bdyh4OJrVb"},{"type":"strong","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"total likelihood","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"A5607cyMvo"}],"key":"yPTHefRm3g"},{"type":"text","value":" across years is the product of these normal pdfs across observations.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"PuhUv8GlcZ"}],"key":"lQfiZlOrE6"},{"type":"thematicBreak","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"JJEQmzTGVu"},{"type":"heading","depth":2,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"strong","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Prior","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"gJUiDLjlHN"}],"key":"UhqwnuQsU8"}],"identifier":"prior","label":"Prior","html_id":"prior","implicit":true,"key":"H0KtM3Yv0c"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":66,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":66,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"Priors are placed on the parameters:","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"tIel3bjwVY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":67,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"inlineMath","value":"r \\sim N(\\mu_r, \\sigma^2_r)","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>μ</mi><mi>r</mi></msub><mo separator=\"true\">,</mo><msubsup><mi>σ</mi><mi>r</mi><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r \\sim N(\\mu_r, \\sigma^2_r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"gUWFxYQVit"}],"key":"mm9UVQH39H"},{"type":"listItem","spread":true,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"inlineMath","value":"k \\sim N(\\mu_k, \\sigma^2_k)","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>μ</mi><mi>k</mi></msub><mo separator=\"true\">,</mo><msubsup><mi>σ</mi><mi>k</mi><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">k \\sim N(\\mu_k, \\sigma^2_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0972em;vertical-align:-0.2831em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"LCOdqBKFJn"}],"key":"t7z3CbyWKa"},{"type":"listItem","spread":true,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"inlineMath","value":"\\sigma \\sim N(\\mu_\\sigma, \\sigma^2_\\sigma)","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>μ</mi><mi>σ</mi></msub><mo separator=\"true\">,</mo><msubsup><mi>σ</mi><mi>σ</mi><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma \\sim N(\\mu_\\sigma, \\sigma^2_\\sigma)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"alxXNUHkTj"}],"key":"SARLQBaFWl"}],"key":"cFdUmQY4gY"}],"key":"tu1Ped5Ls8"},{"type":"listItem","spread":true,"position":{"start":{"line":70,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"These are combined into the total NLL for use in Metropolis-Hastings.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"OByecOmDhB"}],"key":"c7JbxwSxtr"}],"key":"BujUTx6y64"},{"type":"thematicBreak","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"xwWqjeFORA"},{"type":"heading","depth":2,"position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"strong","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Posterior","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"pyGVLTGzKU"}],"key":"FWoKG9PH9L"}],"identifier":"posterior","label":"Posterior","html_id":"posterior","implicit":true,"key":"ZfaNlLnnXW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":76,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"The (unormalized) posterior combines the likelihood and priors:\n","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"z8suUJlu5W"},{"type":"math","value":"p(r, k, \\sigma | \\text{data}) \\propto p(\\text{data} | r, k, \\sigma) \\cdot p(r) \\cdot p(k) \\cdot p(\\sigma)","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>σ</mi><mi mathvariant=\"normal\">∣</mi><mtext>data</mtext><mo stretchy=\"false\">)</mo><mo>∝</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mtext>data</mtext><mi mathvariant=\"normal\">∣</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>σ</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>σ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(r, k, \\sigma | \\text{data}) \\propto p(\\text{data} | r, k, \\sigma) \\cdot p(r) \\cdot p(k) \\cdot p(\\sigma)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\">∣</span><span class=\"mord text\"><span class=\"mord\">data</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∝</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">data</span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"9","key":"O7nC0iqLsR"}],"key":"gIANvIeHTH"}],"key":"wsI0emqabm"},{"type":"thematicBreak","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"jLIOkSaYOn"},{"type":"heading","depth":2,"position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"strong","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Metropolis-Hastings Algorithm Steps in the Code","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"zyuQQt2GuA"}],"key":"vRg8cftcv8"}],"identifier":"metropolis-hastings-algorithm-steps-in-the-code","label":"Metropolis-Hastings Algorithm Steps in the Code","html_id":"metropolis-hastings-algorithm-steps-in-the-code","implicit":true,"key":"jApw5XlMxe"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":85,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"strong","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Initialization:","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"iSWlt7EcmO"}],"key":"xpzswfdIBV"}],"key":"RLW0nqRJlO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":86,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Chains are initialized at given starting values (","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"AiiWyEBA2q"},{"type":"inlineCode","value":"inits","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"oMY4eUUZXR"},{"type":"text","value":").","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"IN95W9UkcW"}],"key":"sGIKpudydK"}],"key":"l3gmQgMIBZ"}],"key":"DiYjwdJNYZ"},{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"strong","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Proposal Step:","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"UikTsxh75w"}],"key":"KA57jpm1Oc"}],"key":"ZsWuq5FQ7S"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":89,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"At each iteration, propose new values for ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"dX7iuZCTjt"},{"type":"inlineMath","value":"r","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"cNJwQxqoku"},{"type":"text","value":", ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"oKjw7X7wXZ"},{"type":"inlineMath","value":"k","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"cGyvk0UO5S"},{"type":"text","value":", and ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"lWpzMOAUfj"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"XAcf583m5U"},{"type":"text","value":" using normal random walks:\n","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"DOeAUQWVh0"},{"type":"math","value":"r^* \\sim N(r^{(t-1)}, \\delta_{1}), \\quad k^* \\sim N(k^{(t-1)}, \\delta_{2}), \\quad \\sigma^* \\sim |N(\\sigma^{(t-1)}, \\delta_{2})|","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>r</mi><mo>∗</mo></msup><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>r</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msub><mi>δ</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi>k</mi><mo>∗</mo></msup><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>k</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msub><mi>δ</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi>σ</mi><mo>∗</mo></msup><mo>∼</mo><mi mathvariant=\"normal\">∣</mi><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msub><mi>δ</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">r^* \\sim N(r^{(t-1)}, \\delta_{1}), \\quad k^* \\sim N(k^{(t-1)}, \\delta_{2}), \\quad \\sigma^* \\sim |N(\\sigma^{(t-1)}, \\delta_{2})|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7387em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span></span>","enumerator":"10","key":"mPW44m66gO"}],"key":"Y7d2Jn1m1k"},{"type":"listItem","spread":true,"position":{"start":{"line":93,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Hard rejection if the proposed ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"htTSeuPGWU"},{"type":"inlineMath","value":"r^* \\leq 0","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>r</mi><mo>∗</mo></msup><mo>≤</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r^* \\leq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;vertical-align:-0.136em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Pz6mv5qxyc"},{"type":"text","value":".","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"oxVPYOyMBv"}],"key":"je1jWwF4mf"}],"key":"DtTOjsZbqE"}],"key":"lSy44cK0TZ"},{"type":"listItem","spread":true,"position":{"start":{"line":95,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"strong","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"Acceptance Ratio:","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"vv9Nysp134"}],"key":"gHq8c0ozt5"}],"key":"xyFxnvHqrN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":96,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"Compute the difference in negative log-likelihoods (including priors) between proposal and current values.","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"JrRIV6HYFT"}],"key":"zVkxwIZC1G"},{"type":"listItem","spread":true,"position":{"start":{"line":97,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"Accept the proposal with probability ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"OOv0XJCOJ2"},{"type":"inlineMath","value":"\\min(1, \\exp(\\text{logR}))","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mtext>logR</mtext><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\min(1, \\exp(\\text{logR}))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">min</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">logR</span></span><span class=\"mclose\">))</span></span></span></span>","key":"XDvMM0nA3m"},{"type":"text","value":".","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"KyXroxbdFe"}],"key":"Tr1lrS0VZy"}],"key":"EolGzpsfXs"}],"key":"edNzQDuxlM"},{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"strong","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Update Step:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"yUd6J6T8LQ"}],"key":"UYbZ4yokjP"}],"key":"XXBdbcigD1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":100,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"If accepted, set ","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"gjNqHj8Qbf"},{"type":"inlineMath","value":"(r, k, \\sigma)^{(t)} = (r^*, k^*, \\sigma^*)","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>σ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>r</mi><mo>∗</mo></msup><mo separator=\"true\">,</mo><msup><mi>k</mi><mo>∗</mo></msup><mo separator=\"true\">,</mo><msup><mi>σ</mi><mo>∗</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r, k, \\sigma)^{(t)} = (r^*, k^*, \\sigma^*)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"j4xp1pHsQH"},{"type":"text","value":"; otherwise, retain previous values.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"pwBHZD4Xmb"}],"key":"Vsl6pg5Kat"},{"type":"listItem","spread":true,"position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Repeat for ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"niBn2Re7LR"},{"type":"inlineCode","value":"nIter","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"MpbH3p02D4"},{"type":"text","value":" iterations, discarding ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"Lcd6Qy88Zv"},{"type":"inlineCode","value":"nBurnIn","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"hC6a4EPslz"},{"type":"text","value":" as burn-in.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"NQKGYEvrP1"}],"key":"bFfJIq0G0Y"}],"key":"meoq7bSbEW"}],"key":"EuUoYoPTPW"}],"key":"N23xaXCMsK"}],"key":"fhJjwHCZE3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom scipy.stats import gaussian_kde","key":"gqW7Aw3SIj"},{"type":"output","id":"v-gqQGoJclwlYnintBfO8","data":[],"key":"RaorMjf23J"}],"key":"KlmareTa5B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def detect_survey_cols(data):\n    # Find all columns that start with 'Survey'\n    return [col for col in data.columns if col.lower().startswith(\"survey\")]\n\ndef NLL(par, data, survey_cols, priorMean, priorVar, printStep=False):\n    r, k, sigma = float(par[0]), float(par[1]), float(par[2])\n    nYears = len(data)\n    B = np.zeros(nYears)\n    B[0] = k\n\n    for t in range(1, nYears):\n        B[t] = max(1, B[t-1] + r * B[t-1] * (1 - B[t-1] / k) - data['C'].iloc[t-1])\n\n    # Likelihood components for each survey\n    NLLs = []\n    for survey_col in survey_cols:\n        survey_vals = data[survey_col]\n        Q   = np.exp(np.nanmean(np.log(survey_vals / B)))\n        PB  = survey_vals / Q\n        SSQ = np.log(B / PB) ** 2\n        idx = ~np.isnan(SSQ)\n        L = 1 / np.sqrt(2 * np.pi * sigma ** 2) * np.exp(-SSQ[idx] / (2 * sigma ** 2))\n        NLLs.append(-np.log(L))\n\n    # Priors\n    rPriorL     = -((r - priorMean[0]) ** 2 / (2 * priorVar[0]))\n    kPriorL     = -((k - priorMean[1]) ** 2 / (2 * priorVar[1]))\n    sigmaPriorL = -((sigma - priorMean[2]) ** 2 / (2 * priorVar[2]))\n    priorL = rPriorL + kPriorL + sigmaPriorL\n\n    # Total negative log-likelihood (minus sum for M-H log acceptance ratio)\n    totalNLL = sum(-np.sum(nll) for nll in NLLs) + priorL\n\n    if printStep:\n        print(f\"r: {r:.4f} k: {k:.2f} sigma: {sigma:.4f} nll: {totalNLL:.2f}\")\n\n    return totalNLL\n\ndef schaeferMCMC(data, inits, nIter, nBurnIn, delta, priors, nChains=2):\n    \"\"\"\n    Metropolis-Hastings sampler for the Schaefer biomass model.\n    Now uses a vector of proposal standard deviations (delta) for each parameter:\n        delta[0] = for r\n        delta[1] = for k\n        delta[2] = for sigma\n    \"\"\"\n    survey_cols = detect_survey_cols(data)\n    priorMean = priors[:3]\n    priorVar  = priors[3:]\n\n    if not (isinstance(delta, (list, tuple, np.ndarray)) and len(delta) == 3):\n        raise ValueError(\"delta must be a list/tuple/array of length 3: [delta_r, delta_k, delta_sigma]\")\n\n    chains = []\n    for chain_idx in range(nChains):\n        r     = np.zeros(nIter)\n        k     = np.zeros(nIter)\n        sigma = np.zeros(nIter)\n\n        if isinstance(inits[0], (list, np.ndarray)):\n            r[0], k[0], sigma[0] = inits[chain_idx]\n        else:\n            r[0], k[0], sigma[0] = inits\n\n        for i in range(1, nIter):\n            rHat     = np.random.normal(r[i-1], delta[0])\n            kHat     = np.random.normal(k[i-1], delta[1])\n            sigmaHat = abs(np.random.normal(sigma[i-1], delta[2]))\n\n            if rHat <= 0:\n                r[i], k[i], sigma[i] = r[i-1], k[i-1], sigma[i-1]\n                continue\n\n            logR = NLL([rHat, kHat, sigmaHat], data, survey_cols, priorMean, priorVar) - \\\n                   NLL([r[i-1], k[i-1], sigma[i-1]], data, survey_cols, priorMean, priorVar)\n\n            accept_prob = min(1, np.exp(logR))\n            if np.random.uniform() <= accept_prob:\n                r[i], k[i], sigma[i] = rHat, kHat, sigmaHat\n            else:\n                r[i], k[i], sigma[i] = r[i-1], k[i-1], sigma[i-1]\n\n        # Burn-in removal\n        rSamples     = r[nBurnIn:]\n        kSamples     = k[nBurnIn:]\n        sigmaSamples = sigma[nBurnIn:]\n\n        chains.append(pd.DataFrame({\n            'r': rSamples,\n            'k': kSamples,\n            'sigma': sigmaSamples\n        }))\n\n    # Plotting\n    fig, axs = plt.subplots(2, 3, figsize=(15, 8))\n    colors = ['black', '#FF000088', 'blue', 'green', 'orange', 'purple']\n    # Traceplots\n    for j, param in enumerate(['r', 'k', 'sigma']):\n        for cidx, chain in enumerate(chains):\n            axs[0, j].plot(chain[param], color=colors[cidx % len(colors)], alpha=0.7, label=f'Chain {cidx+1}' if j==0 else None)\n        axs[0, j].set_title(f'Trace: {param}')\n        if j == 0:\n            axs[0, j].legend()\n    # Density plots\n    for j, param in enumerate(['r', 'k', 'sigma']):\n        for cidx, chain in enumerate(chains):\n            kde = gaussian_kde(chain[param])\n            x_vals = np.linspace(chain[param].min(), chain[param].max(), 200)\n            axs[1, j].plot(x_vals, kde(x_vals), color=colors[cidx % len(colors)], label=f'Chain {cidx+1}')\n        axs[1, j].set_title(f'Density: {param}')\n        axs[1, j].legend()\n    plt.tight_layout()\n    plt.show()\n\n    # Posterior summaries (mean and sd per chain)\n    summaries = []\n    for chain in chains:\n        summaries.append(pd.DataFrame({\n            'Mean': [chain['r'].mean(), chain['k'].mean(), chain['sigma'].mean()],\n            'SD':   [chain['r'].std(),  chain['k'].std(),  chain['sigma'].std()]\n        }, index=['r', 'k', 'sigma']))\n\n    output = {\n        'chains': chains,\n        'summaries': summaries,\n        'survey_cols': survey_cols\n    }\n    return output\n\ndef schaefer_post_plots(data, mcmc_samples, survey_cols):\n    nYears = len(data)\n    nSamples = len(mcmc_samples)\n    biomass_matrix = np.zeros((nSamples, nYears))\n\n    # Calculate biomass time series for each posterior sample\n    for s in range(nSamples):\n        r = mcmc_samples.iloc[s]['r']\n        k = mcmc_samples.iloc[s]['k']\n        B = np.zeros(nYears)\n        B[0] = k\n        for t in range(1, nYears):\n            B[t] = max(1, B[t-1] + r * B[t-1] * (1 - B[t-1] / k) - data['C'].iloc[t-1])\n        biomass_matrix[s, :] = B\n\n    biomass_mean = biomass_matrix.mean(axis=0)\n    biomass_lower = np.percentile(biomass_matrix, 2.5, axis=0)\n    biomass_upper = np.percentile(biomass_matrix, 97.5, axis=0)\n\n    # ----- SCALE THE SURVEYS -----\n    scaled_surveys = {}\n    for survey_col in survey_cols:\n        survey_vals = data[survey_col].values\n        mask = survey_vals > 0\n        # Avoid division by zero or log of zero with masking\n        q = np.exp(np.nanmean(np.log(survey_vals[mask] / biomass_mean[mask])))\n        scaled_surveys[survey_col] = survey_vals / q\n\n    # ----- Plotting -----\n    fig, axs = plt.subplots(1, 3, figsize=(15, 5))\n\n    # 1. Biomass time series with CI and scaled surveys\n    axs[0].plot(biomass_mean, color='black', label='Mean')\n    axs[0].plot(biomass_lower, color='black', linestyle='--', label='Lower CI')\n    axs[0].plot(biomass_upper, color='black', linestyle='--', label='Upper CI')\n    colors = ['red', 'blue', 'green', 'orange', 'purple']\n    for idx, (survey_col, scaled) in enumerate(scaled_surveys.items()):\n        axs[0].plot(np.arange(nYears), scaled, 'o', label=survey_col, color=colors[idx % len(colors)])\n    axs[0].set_ylabel(\"biomass\")\n    axs[0].set_xlabel(\"Index\")\n    axs[0].legend()\n\n    # 2. B/Bmsy\n    k_samples = mcmc_samples['k'].values\n    bbmsy_matrix = biomass_matrix / (k_samples[:, None] / 2)\n    bbmsy_mean = bbmsy_matrix.mean(axis=0)\n    axs[1].plot(bbmsy_mean, color='black')\n    axs[1].set_ylabel(\"biomassSB/(k/2)\")\n    axs[1].set_xlabel(\"Index\")\n    axs[1].set_title(\"B/Bmsy\")\n\n    # 3. F/Fmsy\n    catch = data['C'].values\n    r_samples = mcmc_samples['r'].values\n    f_matrix = catch / biomass_matrix\n    fmsy_matrix = r_samples[:, None] / 2\n    ffmsy_matrix = f_matrix / fmsy_matrix\n    ffmsy_mean = ffmsy_matrix.mean(axis=0)\n    axs[2].plot(ffmsy_mean, color='black')\n    axs[2].set_ylabel(\"FM/Fmsy\")\n    axs[2].set_xlabel(\"Index\")\n    axs[2].set_title(\"F/Fmsy\")\n\n    plt.tight_layout()\n    plt.show()\n\n    return {\n        \"biomass_mean\": biomass_mean,\n        \"biomass_lower\": biomass_lower,\n        \"biomass_upper\": biomass_upper,\n        \"scaled_surveys\": scaled_surveys\n    }","key":"bcJlfxyl1k"},{"type":"output","id":"nrdVlBpKjhdv0jnOB7Z0b","data":[],"key":"e5YAt2xgJE"}],"key":"NyGOpPQDGt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can find some example usage below. Be warned that way more iterations (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QFmx9zJoXl"},{"type":"inlineCode","value":"nIter","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sIsuFOrA2Y"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MSa39mZ7Kr"},{"type":"inlineCode","value":"nBurnIn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HwBEL0RCLn"},{"type":"text","value":") are needed to achieve appropriate chain mixing and accurate parameter estimation. The example in this cookbook runs with fewer iterations due to computational limitations involved in deploying the cookbook.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GQwMKExKqg"}],"key":"CgvISVBHxk"}],"key":"gLn5ddIBSe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Example usage ---\ndata = pd.read_csv('../data/data.csv')\nprint(\"Data loaded:\", data.shape) # rows, cols\n\n# Initial parameters, number of iterations, burn-in, delta, priors\ninits = [0.19, 144000, 0.9] # r, k, sigma\nnIter = 10000 # reduce for testing\nnBurnIn = 1000\ndelta = [0.0075, 20000, 0.05] # proposal distribution variances\npriors = [0.23, 144000, 0.9, 0.005, 50000, 0.01]  # priors: means (1:3) and variances (4:6)\n\nresult = schaeferMCMC(data, inits, nIter, nBurnIn, delta, priors)\n\n# Print means and SDs for each chain\nfor i, summary in enumerate(result['summaries']):\n    print(f\"Chain {i+1} parameter means and SDs:\\n{summary}\\n\")\n\nschaefer_post_plots(data, result['chains'][1], result['survey_cols'])","key":"FsV9jTSxfT"},{"type":"output","id":"LU3GjcqlXKaonXQ9jWNzz","data":[{"output_type":"stream","name":"stdout","text":"Data loaded: (106, 4)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x800 with 6 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"376d6a1190b1020ea6845a97ef5ed744","path":"/bayesian-mcmc-cookbook/_preview/7/build/376d6a1190b1020ea6845a97ef5ed744.png"}}},{"output_type":"stream","name":"stdout","text":"Chain 1 parameter means and SDs:\n                Mean          SD\nr           0.196590    0.002381\nk      144004.395283  169.851543\nsigma       0.826565    0.049192\n\nChain 2 parameter means and SDs:\n                Mean          SD\nr           0.197714    0.004101\nk      144071.332401  257.612135\nsigma       0.809490    0.087585\n\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x500 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f92ab468b93e4d311916a9cb6a14febf","path":"/bayesian-mcmc-cookbook/_preview/7/build/f92ab468b93e4d311916a9cb6a14febf.png"}}},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"{'biomass_mean': array([144071.33240137, 143993.33240137, 143886.74572552, 143783.19298487,\n        143743.04404766, 143708.79517314, 143698.28147606, 143700.83224947,\n        143695.87824455, 143719.89625391, 143727.18753805, 143700.04301501,\n        143694.23788145, 143679.57343893, 143669.79191541, 143636.93266611,\n        143622.53148221, 143610.95883248, 143615.65852152, 143614.43369514,\n        143606.44860176, 143587.03143811, 143579.42731187, 143592.31554398,\n        143609.67191831, 143579.61864068, 143546.46793485, 143502.82478828,\n        143123.74402785, 142348.82271838, 141064.26746619, 140486.33145157,\n        140534.39860593, 140738.39458002, 141007.9510181 , 141176.55728657,\n        141183.19369882, 141200.56358764, 141287.63087051, 141379.1549309 ,\n        141436.26901438, 141346.50823095, 141113.83538806, 140984.35075614,\n        140909.3888667 , 140709.59962451, 140681.51761669, 140577.71969585,\n        140817.45698805, 140845.00668951, 141208.35246282, 137475.89371783,\n        133898.96416368, 133379.89446773, 134489.49884357, 135405.49704732,\n        135923.26507217, 136523.57365414, 136781.09999778, 137245.94632715,\n        137658.88687017, 137549.68958718, 137695.15839659, 137330.44876238,\n        129213.2949886 , 110006.48034526,  87289.66078421,  68060.18878654,\n         64717.50892244,  61420.97204535,  59056.24506541,  56171.82704669,\n         49853.0976733 ,  45653.48822678,  39109.8542655 ,  34280.63070622,\n         32647.73699401,  31226.17654525,  27711.99632705,  25415.95857702,\n         22636.26846206,  20079.45390881,  16829.92551243,  15600.97071912,\n         14221.17409153,  12684.33012669,  12954.3889244 ,  14778.57628516,\n         17250.10566857,  20017.17341102,  23033.41204216,  26392.43510368,\n         30094.90253356,  34146.58575077,  38650.80962096,  43527.87012205,\n         48709.33874591,  54120.90434684,  59582.81613357,  64977.55624874,\n         70694.02661813,  76380.53984834,  77768.27618744,  74654.77691666,\n         71735.5757199 ,  69934.88543717]),\n 'biomass_lower': array([143459.08761162, 143381.08761162, 143274.58953477, 143171.22992777,\n        143131.3557796 , 143097.37661085, 143087.12175225, 143089.89565089,\n        143085.12080749, 143109.29052657, 143116.67832711, 143089.6041466 ,\n        143083.88697058, 143069.30075776, 143059.59955724, 143026.81683409,\n        143012.51518346, 143001.04000443, 143005.83228422, 143004.67766919,\n        142996.75119753, 142977.39083819, 142969.85496651, 142982.80746643,\n        143000.20168686, 142970.15960123, 142937.05193735, 142893.48136217,\n        142514.50914046, 141740.10252011, 140464.57286807, 139917.65384303,\n        139998.56177203, 140199.42662091, 140466.3880218 , 140633.45736837,\n        140639.20451326, 140655.87282826, 140742.41172795, 140833.69109118,\n        140890.79812276, 140801.15009266, 140568.38164801, 140438.33825164,\n        140362.65891599, 140162.13713334, 140133.0520519 , 140028.38794884,\n        140267.21242369, 140294.52383048, 140657.73491995, 136925.92417168,\n        133341.86883215, 132809.8364418 , 133912.58814299, 134832.59200115,\n        135352.82718936, 135954.67931808, 136212.87569803, 136678.00863725,\n        137090.69333627, 136980.83725526, 137125.86993672, 136760.63827863,\n        128643.43588008, 109444.28188183,  86745.40635092,  67453.56907229,\n         63964.00852169,  60514.01496913,  58008.09726558,  54982.61362288,\n         48518.97623131,  44158.89790068,  37432.4687904 ,  32384.96762528,\n         30512.51887563,  28818.63315206,  24994.71868513,  22331.61653172,\n         19123.08257543,  16058.52794823,  12206.71296102,  10251.43445871,\n          8018.23241016,   5473.24630928,   4545.37036477,   4980.95957957,\n          5883.43038589,   6904.74821183,   8000.79770425,   9271.76941973,\n         10735.32984949,  12423.26859856,  14475.22153254,  16865.62783321,\n         19588.94642251,  22641.19318674,  25917.39418686,  29366.17104062,\n         33433.15851873,  37861.07733068,  38440.22284495,  34557.58122194,\n         30407.61932508,  26837.88420996]),\n 'biomass_upper': array([144523.78384894, 144445.78384894, 144338.85695118, 144234.56667721,\n        144193.3746955 , 144158.11300617, 144146.63630094, 144148.36720287,\n        144142.7651789 , 144166.24063289, 144173.20032094, 144145.82095183,\n        144139.70867723, 144124.77197499, 144114.70762462, 144081.5783284 ,\n        144066.81682665, 144054.89169293, 144059.25750384, 144057.78464033,\n        144049.59472033, 144029.9780138 , 144022.12877878, 144034.78673415,\n        144052.0140593 , 144021.93263715, 143988.62825303, 143944.71704196,\n        143565.23057454, 142788.33689579, 141498.85500045, 140911.48126209,\n        140949.46019197, 141145.46107388, 141409.38843549, 141574.57816454,\n        141579.16862021, 141594.90771032, 141680.72733334, 141771.61648739,\n        141828.61264201, 141739.00400083, 141506.06417727, 141375.35482951,\n        141298.83977555, 141097.46644184, 141067.23661058, 140961.57333374,\n        141199.3477992 , 141226.33941573, 141589.35134203, 137858.20169971,\n        134266.54694686, 133730.32974966, 134825.35630815, 135757.91408199,\n        136285.27033033, 136891.12634321, 137150.45243464, 137615.58150978,\n        138026.58513436, 137913.86407045, 138056.95826604, 137689.62235395,\n        129572.01943279, 110400.62698796,  87784.43700231,  68899.55261983,\n         65972.08704917,  63104.50694777,  61188.39904722,  58803.79379177,\n         53033.97520564,  49444.34458195,  43574.08562514,  39514.93034753,\n         38760.11119957,  38317.88314122,  35897.45446033,  34860.3916974 ,\n         33517.38436843,  32618.00364407,  31283.29593848,  32296.348425  ,\n         33474.46704567,  34858.25744126,  38465.01852993,  43977.02712164,\n         50371.0308539 ,  57182.32360347,  64245.85008948,  71520.87617126,\n         78851.92596405,  86086.22710437,  93178.85163196,  99909.8766992 ,\n        106116.51246901, 111682.91788339, 116442.57495243, 120357.31400418,\n        123937.28974322, 126898.95948224, 125107.43223781, 119086.59629882,\n        114063.74364582, 110728.64353955]),\n 'scaled_surveys': {'Survey 1': array([           nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n         51410.79958775,            nan,            nan, 76797.36173258,\n                    nan,            nan, 41427.63853219,            nan,\n                    nan, 27526.31703396,            nan,            nan,\n         52721.57658937,            nan,            nan, 41696.8792136 ,\n                    nan,            nan, 68854.76163089,            nan,\n                    nan, 14035.94183894,            nan,            nan,\n          7574.16548502,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan,            nan,            nan,\n                    nan,            nan]),\n  'Survey 2': array([            nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,             nan,\n                     nan,             nan,             nan,  10117.67826399,\n          14585.58167642,   4772.93029605,   4665.50880685,  14630.12516045,\n           8536.63922697,  43395.06917649,  69445.75971479,  69913.72094325,\n          87040.8668471 ,  85721.2122652 , 130890.92988776, 107490.36117958,\n         160978.85847352, 141455.72757413, 111200.94701081,             nan,\n                     nan,             nan])}}","content_type":"text/plain"}}}],"key":"R3pPGIx9vX"}],"key":"ciE4W8BEyF"}],"key":"I4SqdAqdrF"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"A MCMC implementation for a Bayesian Poisson Regression","url":"/notebooks/poisson-mcmc","group":"Applying MCMC algorithms to a variety of Bayesian models"}}},"domain":"http://localhost:3000"}